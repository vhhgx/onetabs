# P3 - 增强功能和优化（低优先级）

**目标**: 跨系统转换、智能功能、用户体验增强

**开发周期**: 视需求而定（可分多个迭代）

**前置依赖**: P0 + P1 + P2（核心功能已完成）

---

## 1. 跨系统数据转换

### 1.1 书签 → 收藏集转换
- [ ] 在 collectionsStore 中添加转换功能
- [ ] `createCollectionFromBookmarks(bookmarkIds)` action
  - [ ] 从 bookmarksStore 获取选中的书签
  - [ ] 转换书签为标签页格式
    ```javascript
    {
      id: bookmark.id,
      title: bookmark.name,
      url: bookmark.url,
      favIconUrl: bookmark.favIconUrl
    }
    ```
  - [ ] 创建新收藏集
  - [ ] Toast提示："已创建收藏集"
- [ ] 在书签右键菜单中添加选项
  - [ ] "添加到收藏集"
  - [ ] 弹出收藏集选择对话框或创建新收藏集
- [ ] 批量转换支持
  - [ ] 在多选模式下添加"添加到收藏集"按钮

### 1.2 书签分类 → 收藏集转换
- [ ] 在分类右键菜单中添加选项
  - [ ] "转换为收藏集"
- [ ] `createCollectionFromCategory(categoryId)` action
  - [ ] 获取分类下所有书签
  - [ ] 批量转换为标签页格式
  - [ ] 创建收藏集，使用分类名称
  - [ ] Toast提示："已将分类转换为收藏集"

### 1.3 书签 → 模板转换
- [ ] 在 templatesStore 中添加转换功能
- [ ] `createTemplateFromBookmarks(bookmarkIds, templateName)` action
  - [ ] 从 bookmarksStore 获取书签
  - [ ] 转换为标签页格式
  - [ ] 创建新模板
  - [ ] Toast提示："已创建模板"
- [ ] 在书签右键菜单中添加选项
  - [ ] "创建为模板"
  - [ ] 弹出对话框输入模板名称和描述
- [ ] 书签分类转模板
  - [ ] 分类右键菜单添加"转换为模板"
  - [ ] `createTemplateFromCategory(categoryId)` action

### 1.4 会话/收藏集/模板 → 书签转换
- [ ] 在 bookmarksStore 中添加转换功能
- [ ] `createCategoryFromSession(sessionId)` action
  - [ ] 从 sessionsStore 获取会话
  - [ ] 转换标签页为书签格式
  - [ ] 创建新书签分类（使用会话创建时间作为名称）
  - [ ] 添加所有书签到分类
  - [ ] Toast提示："已将会话转换为书签分类"
- [ ] `createCategoryFromCollection(collectionId)` action
  - [ ] 类似会话转换
- [ ] `createCategoryFromTemplate(templateId)` action
  - [ ] 类似会话转换
- [ ] 在会话/收藏集/模板右键菜单中添加选项
  - [ ] "保存为书签"
  - [ ] 弹出对话框选择目标书签分类

### 1.5 ConvertDialog 组件
- [ ] 创建 `src/components/ConvertDialog.vue`
- [ ] 统一的转换对话框
  - [ ] 标题根据转换类型动态显示
  - [ ] 转换选项配置
  - [ ] 目标选择（选择现有分类/收藏集/模板或创建新的）
  - [ ] 转换预览（显示将要转换的项数）
  - [ ] 确认按钮

---

## 2. 智能功能

### 2.1 书签智能推荐
- [ ] 创建 `src/utils/bookmarkRecommender.js`
- [ ] 基于访问频率推荐
  - [ ] `getFrequentBookmarks(limit = 10)` - 最常访问的书签
  - [ ] 统计 visitCount 字段
  - [ ] 返回 Top N 书签
- [ ] 基于收藏推荐
  - [ ] `getRecommendedByFavorites()` - 根据收藏书签推荐相似书签
  - [ ] 提取收藏书签的标签
  - [ ] 查找具有相似标签的其他书签
- [ ] 在首页或侧边栏显示推荐区域
  - [ ] "为你推荐" 板块
  - [ ] 推荐书签卡片展示

### 2.2 重复书签检测
- [ ] `detectDuplicateBookmarks()` - 检测重复书签
  - [ ] 按 URL 分组
  - [ ] 找出相同 URL 的书签
  - [ ] 返回重复书签列表
- [ ] 在 Settings → 数据管理中添加"检测重复书签"功能
- [ ] 显示重复书签列表
  - [ ] 显示每组重复书签
  - [ ] 提供合并或删除选项
  - [ ] 保留哪个书签（手动选择或保留最新的）

### 2.3 失效链接检测
- [ ] `detectBrokenLinks()` - 检测失效链接
  - [ ] 遍历所有书签
  - [ ] 发送 HEAD 请求检查链接状态
  - [ ] 标记返回 404/500 的链接
  - [ ] 返回失效链接列表
- [ ] 在 Settings 中添加"检测失效链接"功能
- [ ] 显示失效链接列表
  - [ ] 提供删除或更新URL选项
- [ ] 性能优化
  - [ ] 使用 Web Worker 后台检测
  - [ ] 分批检测避免阻塞
  - [ ] 提供取消检测功能

### 2.4 自动标签建议
- [ ] 在书签编辑对话框中添加标签建议
- [ ] `suggestTags(url, name)` - 根据URL和名称建议标签
  - [ ] 从域名提取关键词（如 github.com → "开发"）
  - [ ] 从标题提取关键词
  - [ ] 统计现有书签的常用标签
  - [ ] 返回建议的标签列表
- [ ] 显示建议标签
  - [ ] 点击快速添加到标签输入框

---

## 3. 标签系统增强

### 3.1 标签管理
- [ ] 创建 `src/components/TagManager.vue`
- [ ] 标签云展示
  - [ ] 显示所有使用过的标签
  - [ ] 标签大小根据使用频率调整
  - [ ] 点击标签筛选书签
- [ ] 标签CRUD
  - [ ] 添加新标签
  - [ ] 重命名标签（批量更新所有书签）
  - [ ] 删除标签（从所有书签移除）
  - [ ] 合并标签（将一个标签替换为另一个）
- [ ] 标签颜色
  - [ ] 为标签设置颜色
  - [ ] 在书签卡片中显示彩色标签

### 3.2 bookmarksStore 标签功能
- [ ] `getAllTags()` getter - 获取所有标签及使用次数
- [ ] `getBookmarksByTag(tag)` getter - 按标签筛选书签（已有）
- [ ] `renameTag(oldTag, newTag)` action - 重命名标签
  - [ ] 遍历所有书签
  - [ ] 替换标签名称
  - [ ] 保存数据
- [ ] `deleteTag(tag)` action - 删除标签
  - [ ] 从所有书签移除该标签
  - [ ] 保存数据
- [ ] `mergeTags(sourceTags, targetTag)` action - 合并标签
  - [ ] 将多个标签合并为一个
  - [ ] 更新所有书签
  - [ ] 保存数据

---

## 4. 快捷键系统

### 4.1 shortcuts 工具
- [ ] 扩展现有的 `src/utils/shortcuts.js`
- [ ] 注册书签相关快捷键
  - [ ] `Ctrl/Cmd + B` - 聚焦书签搜索框
  - [ ] `Ctrl/Cmd + N` - 添加新书签
  - [ ] `Ctrl/Cmd + Shift + N` - 添加新分类
  - [ ] `Ctrl/Cmd + Shift + I` - 打开导入对话框
  - [ ] `Ctrl/Cmd + Shift + B` - 同步到浏览器
  - [ ] `Ctrl/Cmd + Shift + F` - 打开收藏区域
  - [ ] `Ctrl/Cmd + Shift + M` - 进入批量管理模式
  - [ ] `Esc` - 退出多选模式/关闭对话框
- [ ] 快捷键提示
  - [ ] 在相关按钮显示快捷键提示（Tooltip）
  - [ ] 在 Settings 中显示所有快捷键列表

### 4.2 ShortcutsHelp 组件
- [ ] 使用现有的 `src/components/ShortcutsHelp.vue`
- [ ] 添加书签相关快捷键说明
- [ ] 快捷键分组展示
  - [ ] 通用快捷键
  - [ ] 书签快捷键
  - [ ] 标签页快捷键
- [ ] 通过 `?` 键打开快捷键帮助

---

## 5. 拖拽增强

### 5.1 书签拖拽排序
- [ ] 在书签列表中支持拖拽排序
- [ ] 使用 Sortable.js
- [ ] 拖拽功能
  - [ ] 拖拽书签卡片调整顺序
  - [ ] 跨分类拖拽（移动到其他分类）
  - [ ] 拖拽时显示视觉反馈
  - [ ] 拖拽结束保存新顺序
- [ ] bookmarksStore 支持
  - [ ] 书签顺序存储（order 字段或数组顺序）
  - [ ] `reorderBookmarks(categoryPath, newOrder)` action
  - [ ] `moveBookmark(bookmarkId, targetCategoryPath)` action（已有）

### 5.2 分类拖拽排序
- [ ] 一级分类标签拖拽排序
  - [ ] 拖拽标签调整顺序
  - [ ] 保存新顺序
- [ ] 二级/三级分类拖拽排序
  - [ ] 在侧边栏支持拖拽
  - [ ] 保存新顺序
- [ ] 跨层级拖拽（可选）
  - [ ] 将三级分类拖拽到另一个二级分类下
  - [ ] 将二级分类拖拽到另一个一级分类下

---

## 6. 数据可视化

### 6.1 统计图表
- [ ] 安装 Chart.js 或 ECharts
- [ ] 在 Settings → 数据统计中添加图表
- [ ] 图表类型
  - [ ] 书签数量趋势图（按创建时间）
  - [ ] 分类分布饼图
  - [ ] 访问频率柱状图
  - [ ] 标签使用热力图
- [ ] 交互功能
  - [ ] 点击图表跳转到对应书签
  - [ ] 图表数据导出

### 6.2 使用习惯分析
- [ ] `analyzeUsagePatterns()` - 分析使用习惯
  - [ ] 最常访问的时间段
  - [ ] 最常访问的分类
  - [ ] 收藏增长趋势
  - [ ] 标签使用统计
- [ ] 在 Settings 中显示分析报告
- [ ] 提供优化建议
  - [ ] "你可以删除长时间未访问的书签"
  - [ ] "建议为常用书签添加标签"

---

## 7. 导入导出增强

### 7.1 多格式导出
- [ ] 导出为HTML（Chrome书签格式）
  - [ ] `exportToHtml()` action
  - [ ] 生成标准的Chrome书签HTML
  - [ ] 保持三级文件夹结构
- [ ] 导出为Markdown
  - [ ] `exportToMarkdown()` action
  - [ ] 按分类生成Markdown列表
  - [ ] 支持链接和描述
- [ ] 导出为CSV
  - [ ] `exportToCsv()` action
  - [ ] 导出为表格格式
  - [ ] 列：名称、URL、描述、标签、分类、创建时间

### 7.2 导入增强
- [ ] 支持从其他书签管理工具导入
  - [ ] Pocket JSON格式
  - [ ] Raindrop.io CSV格式
  - [ ] Firefox书签HTML
- [ ] 导入映射配置
  - [ ] 字段映射配置界面
  - [ ] 预览导入数据
  - [ ] 导入前验证

---

## 8. 主题和UI增强

### 8.1 自定义主题
- [ ] 在 Settings 中添加主题编辑器
- [ ] 颜色方案编辑
  - [ ] 主色调选择
  - [ ] 背景色调整
  - [ ] 文字色调整
  - [ ] 边框色调整
- [ ] 预设主题包
  - [ ] 经典蓝
  - [ ] 科技紫
  - [ ] 清新绿
  - [ ] 暗夜黑
- [ ] 导入/导出主题配置
- [ ] 实时预览主题效果

### 8.2 布局自定义
- [ ] 在 Settings 中添加布局设置
- [ ] 布局选项
  - [ ] 书签卡片大小：小、中、大
  - [ ] 书签卡片间距
  - [ ] 侧边栏宽度
  - [ ] 固定栏位置：顶部、底部、不显示
- [ ] 字体设置
  - [ ] 字体大小调整
  - [ ] 字体家族选择

### 8.3 动画效果
- [ ] 添加流畅的动画效果
  - [ ] 页面切换动画
  - [ ] 卡片进入/退出动画
  - [ ] 拖拽动画优化
  - [ ] 加载动画
- [ ] 性能优化
  - [ ] 使用 CSS Transform 和 Opacity
  - [ ] 避免重排重绘
  - [ ] 提供禁用动画选项（性能模式）

---

## 9. 社交和分享功能

### 9.1 分享书签分类
- [ ] 创建 `src/utils/shareManager.js`
- [ ] 生成分享链接
  - [ ] `generateShareLink(categoryId)` - 生成分享链接
  - [ ] 将分类数据编码为URL参数或生成短链接
  - [ ] 返回可分享的链接
- [ ] 生成二维码
  - [ ] 使用 QRCode.js 生成二维码
  - [ ] 显示二维码图片
  - [ ] 提供下载二维码功能
- [ ] 导出为HTML网页
  - [ ] 生成静态HTML页面
  - [ ] 包含所有书签和分类
  - [ ] 支持在线查看
- [ ] 分享到社交平台（可选）
  - [ ] 分享到Twitter、Facebook等
  - [ ] 预填充分享文本

### 9.2 ShareDialog 组件
- [ ] 创建 `src/components/ShareDialog.vue`
- [ ] 分享选项
  - [ ] 生成分享链接
  - [ ] 生成二维码
  - [ ] 导出HTML网页
  - [ ] 复制到剪贴板
- [ ] 在分类右键菜单中添加"分享"选项

---

## 10. 云端同步（可选）

### 10.1 chrome.storage.sync 集成
- [ ] 启用 chrome.storage.sync
- [ ] 同步设置
  - [ ] 在 Settings 中添加云同步开关
  - [ ] 选择同步内容：书签、设置、主题
- [ ] 同步逻辑
  - [ ] 数据变化时自动同步到 chrome.storage.sync
  - [ ] 冲突处理：最新优先、手动选择
- [ ] 同步状态显示
  - [ ] 显示同步时间
  - [ ] 显示同步状态（同步中、已同步、失败）

### 10.2 自定义云端存储（高级）
- [ ] 支持第三方云存储（如Google Drive、Dropbox）
- [ ] OAuth认证集成
- [ ] 数据加密上传
- [ ] 自动备份到云端
- [ ] 从云端恢复数据

---

## 11. 多语言支持

### 11.1 i18n 集成
- [ ] 安装 vue-i18n
- [ ] 创建语言文件
  - [ ] `src/locales/zh-CN.json` - 简体中文
  - [ ] `src/locales/en-US.json` - 英文
  - [ ] `src/locales/ja-JP.json` - 日文（可选）
- [ ] 配置 i18n 插件
- [ ] 翻译所有UI文本
  - [ ] 页面标题
  - [ ] 按钮文本
  - [ ] 提示信息
  - [ ] 错误消息
- [ ] 在 Settings 中添加语言切换
- [ ] 动态切换语言
  - [ ] 切换后立即生效
  - [ ] 保存语言偏好

---

## 12. 无障碍支持

### 12.1 键盘导航
- [ ] 确保所有功能可通过键盘操作
- [ ] Tab键导航顺序合理
- [ ] 焦点可见（outline样式）
- [ ] Enter键确认操作

### 12.2 屏幕阅读器支持
- [ ] 添加 ARIA 属性
  - [ ] `aria-label`
  - [ ] `aria-describedby`
  - [ ] `role` 属性
- [ ] 语义化HTML标签
- [ ] 图片添加 alt 属性

### 12.3 对比度优化
- [ ] 确保文字和背景对比度符合 WCAG AA 标准
- [ ] 提供高对比度主题选项

---

## 13. 性能监控和错误追踪

### 13.1 性能监控
- [ ] 添加性能监控代码
- [ ] 监控指标
  - [ ] 页面加载时间
  - [ ] 书签数据加载时间
  - [ ] 搜索响应时间
  - [ ] 内存使用情况
- [ ] 在开发模式下显示性能指标
- [ ] 性能优化建议

### 13.2 错误追踪
- [ ] 集成 Sentry 或自定义错误追踪
- [ ] 捕获未处理的错误
- [ ] 记录错误堆栈
- [ ] 错误上报（可选，需用户同意）
- [ ] 在 Settings 中显示错误日志

---

## 14. 测试完善

### 14.1 单元测试
- [ ] 安装 Vitest
- [ ] 编写 Store 单元测试
  - [ ] bookmarksStore 所有 actions 和 getters
  - [ ] settingsStore 书签设置相关
- [ ] 编写工具函数测试
  - [ ] urlValidator.js
  - [ ] bookmarkImporter.js
  - [ ] bookmarkSyncManager.js
- [ ] 测试覆盖率 >80%

### 14.2 端到端测试（可选）
- [ ] 安装 Playwright 或 Cypress
- [ ] 编写关键流程测试
  - [ ] 添加书签流程
  - [ ] 导入书签流程
  - [ ] 搜索书签流程
  - [ ] 同步到浏览器流程
- [ ] 自动化测试运行

---

## 15. 文档完善

### 15.1 用户文档
- [ ] 编写用户手册
  - [ ] 快速入门指南
  - [ ] 功能详细说明
  - [ ] 常见问题解答
  - [ ] 快捷键列表
- [ ] 录制视频教程（可选）
- [ ] 创建在线帮助页面

### 15.2 开发文档
- [ ] 完善代码注释
- [ ] 编写 API 文档
- [ ] 编写贡献指南
- [ ] 编写架构设计文档

---

## 验收标准

- [ ] 所有跨系统转换功能正常工作
- [ ] 智能推荐、重复检测、失效检测功能正常
- [ ] 标签系统完整可用
- [ ] 快捷键系统完整
- [ ] 拖拽功能流畅
- [ ] 数据可视化图表正确显示
- [ ] 多格式导入导出正常
- [ ] 自定义主题和布局正常
- [ ] 分享功能正常
- [ ] 云同步功能正常（如启用）
- [ ] 多语言切换正常
- [ ] 无障碍支持符合标准
- [ ] 性能监控和错误追踪正常工作
- [ ] 测试覆盖率达标
- [ ] 文档完善

---

**前置依赖**: P0 + P1 + P2

**说明**: P3为增强功能，可以根据实际需求分多个迭代完成，不是所有功能都必须实现。优先级可以根据用户反馈调整。
